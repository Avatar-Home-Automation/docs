
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../meteo/">
      
      
        <link rel="next" href="../meteo-widget-client/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Create a window - A.V.A.T.A.R</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      
  
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
    
    
  
  
  <style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M64 32C28.7 32 0 60.7 0 96v320c0 35.3 28.7 64 64 64h224V368c0-26.5 21.5-48 48-48h112V96c0-35.3-28.7-64-64-64zm384 320H336c-8.8 0-16 7.2-16 16v112l32-32 64-64z"/></svg>');--md-admonition-icon--abstract:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M96 0C43 0 0 43 0 96v320c0 53 43 96 96 96h320c17.7 0 32-14.3 32-32s-14.3-32-32-32v-64c17.7 0 32-14.3 32-32V32c0-17.7-14.3-32-32-32H96m0 384h256v64H96c-17.7 0-32-14.3-32-32s14.3-32 32-32m32-240c0-8.8 7.2-16 16-16h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16m16 48h192c8.8 0 16 7.2 16 16s-7.2 16-16 16H144c-8.8 0-16-7.2-16-16s7.2-16 16-16"/></svg>');--md-admonition-icon--info:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512m-40-176h24v-64h-24c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24h-80c-13.3 0-24-10.7-24-24s10.7-24 24-24m40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64"/></svg>');--md-admonition-icon--tip:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M480 32c0-12.9-7.8-24.6-19.8-29.6S434.5.2 425.3 9.3L381.7 53c-48 48-113.1 75-181 75H64c-35.3 0-64 28.7-64 64v96c0 35.3 28.7 64 64 64v128c0 17.7 14.3 32 32 32h64c17.7 0 32-14.3 32-32V352h8.7c67.9 0 133 27 181 75l43.6 43.6c9.2 9.2 22.9 11.9 34.9 6.9s19.8-16.6 19.8-29.6V300.3c18.6-8.8 32-32.5 32-60.4s-13.4-51.6-32-60.4zm-64 76.7v262.6C357.2 317.8 280.5 288 200.7 288H192v-96h8.7c79.8 0 156.5-29.8 215.3-83.3"/></svg>');--md-admonition-icon--success:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7l233.4-233.3c12.5-12.5 32.8-12.5 45.3 0z"/></svg>');--md-admonition-icon--question:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 512a256 256 0 1 0 0-512 256 256 0 1 0 0 512m-86.2-346.7c7.9-22.3 29.1-37.3 52.8-37.3h58.3c34.9 0 63.1 28.3 63.1 63.1 0 22.6-12.1 43.5-31.7 54.8L280 264.4c-.2 13-10.9 23.6-24 23.6-13.3 0-24-10.7-24-24v-13.5c0-8.6 4.6-16.5 12.1-20.8l44.3-25.4c4.7-2.7 7.6-7.7 7.6-13.1 0-8.4-6.8-15.1-15.1-15.1h-58.3c-3.4 0-6.4 2.1-7.5 5.3l-.4 1.2c-4.4 12.5-18.2 19-30.6 14.6s-19-18.2-14.6-30.6l.4-1.2zM224 352a32 32 0 1 1 64 0 32 32 0 1 1-64 0"/></svg>');--md-admonition-icon--warning:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M256 32c14.2 0 27.3 7.5 34.5 19.8l216 368c7.3 12.4 7.3 27.7.2 40.1S486.3 480 472 480H40c-14.3 0-27.6-7.7-34.7-20.1s-7-27.8.2-40.1l216-368C228.7 39.5 241.8 32 256 32m0 128c-13.3 0-24 10.7-24 24v112c0 13.3 10.7 24 24 24s24-10.7 24-24V184c0-13.3-10.7-24-24-24m32 224a32 32 0 1 0-64 0 32 32 0 1 0 64 0"/></svg>');--md-admonition-icon--failure:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.1 52.4 442.6 6.5c-1.9-3.9-6.1-6.5-10.5-6.5s-8.5 2.6-10.4 6.5l-16.5 45.9-46 16.8c-4.3 1.6-7.3 5.9-7.2 10.4 0 4.5 3 8.7 7.2 10.2l45.7 16.8 16.8 45.8c1.5 4.4 5.8 7.5 10.4 7.5s8.9-3.1 10.4-7.5l16.5-45.8 45.7-16.8c4.2-1.5 7.2-5.7 7.2-10.2 0-4.6-3-8.9-7.2-10.4zm-132.4 53c-12.5-12.5-32.8-12.5-45.3 0l-2.9 2.9c-22-8-45.8-12.3-70.5-12.3C93.1 96 0 189.1 0 304s93.1 208 208 208 208-93.1 208-208c0-24.7-4.3-48.5-12.2-70.5l2.9-2.9c12.5-12.5 12.5-32.8 0-45.3l-80-80zM200 192c-57.4 0-104 46.6-104 104v8c0 8.8-7.2 16-16 16s-16-7.2-16-16v-8c0-75.1 60.9-136 136-136h8c8.8 0 16 7.2 16 16s-7.2 16-16 16z"/></svg>');--md-admonition-icon--danger:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 398.9c58.5-41.1 96-104.1 96-174.9C512 100.3 397.4 0 256 0S0 100.3 0 224c0 70.7 37.5 133.8 96 174.9V464c0 26.5 21.5 48 48 48h48v-48c0-8.8 7.2-16 16-16s16 7.2 16 16v48h64v-48c0-8.8 7.2-16 16-16s16 7.2 16 16v48h48c26.5 0 48-21.5 48-48v-65.1M96 256a64 64 0 1 1 128 0 64 64 0 1 1-128 0m256-64a64 64 0 1 1 0 128 64 64 0 1 1 0-128"/></svg>');--md-admonition-icon--bug:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M320 0c17.7 0 32 14.3 32 32v64h120c39.8 0 72 32.2 72 72v272c0 39.8-32.2 72-72 72H168c-39.8 0-72-32.2-72-72V168c0-39.8 32.2-72 72-72h120V32c0-17.7 14.3-32 32-32M208 384c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zm96 0c-8.8 0-16 7.2-16 16s7.2 16 16 16h32c8.8 0 16-7.2 16-16s-7.2-16-16-16zM264 256a40 40 0 1 0-80 0 40 40 0 1 0 80 0m152 40a40 40 0 1 0 0-80 40 40 0 1 0 0 80M48 224h16v192H48c-26.5 0-48-21.5-48-48v-96c0-26.5 21.5-48 48-48m544 0c26.5 0 48 21.5 48 48v96c0 26.5-21.5 48-48 48h-16V224z"/></svg>');--md-admonition-icon--example:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M288 0H128c-17.7 0-32 14.3-32 32s14.3 32 32 32v132.8c0 11.8-3.3 23.5-9.5 33.5L10.3 406.2C3.6 417.2 0 429.7 0 442.6 0 480.9 31.1 512 69.4 512h309.2c38.3 0 69.4-31.1 69.4-69.4 0-12.8-3.6-25.4-10.3-36.4L329.5 230.4c-6.2-10.1-9.5-21.7-9.5-33.5V64c17.7 0 32-14.3 32-32S337.7 0 320 0zm-96 196.8V64h64v132.8c0 23.7 6.6 46.9 19 67.1l34.5 56.1h-171l34.5-56.1c12.4-20.2 19-43.4 19-67.1"/></svg>');--md-admonition-icon--quote:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M0 216C0 149.7 53.7 96 120 96h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64H64c-35.3 0-64-28.7-64-64V216m256 0c0-66.3 53.7-120 120-120h8c17.7 0 32 14.3 32 32s-14.3 32-32 32h-8c-30.9 0-56 25.1-56 56v8h64c35.3 0 64 28.7 64 64v64c0 35.3-28.7 64-64 64h-64c-35.3 0-64-28.7-64-64V216"/></svg>');}</style>


  
  
  
  
  <style>:root{--md-annotation-icon:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 20c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8m0-18A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10A10 10 0 0 0 12 2m1 5h-2v4H7v2h4v4h2v-4h4v-2h-4z"/></svg>');}</style>


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="dark" data-md-color-primary="blue-grey" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#create-a-window" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="A.V.A.T.A.R" class="md-header__button md-logo" aria-label="A.V.A.T.A.R" data-md-component="logo">
      
  <img src="../img/Avatar.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            A.V.A.T.A.R
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Create a window
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="dark" data-md-color-primary="blue-grey" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4m0-7c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="blue-grey" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../introduction/" class="md-tabs__link">
          
  
  Installation

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../getting-started/" class="md-tabs__link">
          
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../developer-guide/" class="md-tabs__link">
          
  
  Developer Guide

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../about/" class="md-tabs__link">
        
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="A.V.A.T.A.R" class="md-nav__button md-logo" aria-label="A.V.A.T.A.R" data-md-component="logo">
      
  <img src="../img/Avatar.png" alt="logo">

    </a>
    A.V.A.T.A.R
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../introduction/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Server
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Server
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../server-installer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    By the Installer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2_2" id="__nav_2_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Manual installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2_2">
            <span class="md-nav__icon md-icon"></span>
            Manual installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windows-server-install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../macos-server-install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    macOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linux-server-install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Client
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Client
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client-installer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    By the Installer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3_2" >
        
          
          <label class="md-nav__link" for="__nav_2_3_2" id="__nav_2_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Manual installation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_2_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3_2">
            <span class="md-nav__icon md-icon"></span>
            Manual installation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../windows-client-install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Windows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../macos-client-install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    macOS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../linux-client-install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../certificate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    HTTPS certificate
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../test-install/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Testing the installation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../update-application/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Updating Server/Client
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Uninstallation
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Uninstallation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../server-uninstaller/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client-uninstaller/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Client
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Settings
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Settings
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_1" >
        
          
          <label class="md-nav__link" for="__nav_3_2_1" id="__nav_3_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Server
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_1">
            <span class="md-nav__icon md-icon"></span>
            Server
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../server-properties/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Menu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../server-settings-tab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Settings tab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../server-nodes-tab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Nodes tab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../server-dialog-tab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dialog tab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../server-background-tab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Background tab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../server-console-tab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Console tab
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2_2" id="__nav_3_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Client
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2_2">
            <span class="md-nav__icon md-icon"></span>
            Client
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client-properties/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Menu
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client-settings-tab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Settings tab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client-dialog-tab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Dialog tab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client-voices-tab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Voices tab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client-rules-tab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Rules tab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client-interface-tab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Interface tab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client-intercom-tab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intercom tab
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../client-background-tab/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Background tab
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Concepts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../voice-rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Voice rules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugin-rules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plugin rules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../virtual-client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Virtual client
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tools
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugin-studio/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Plugin Studio
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Developer Guide
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Developer Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developer-guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorial
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Tutorial
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial-prerequisites/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prerequisites
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial-create-plugin/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create a plugin
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial-plugin-folders-files/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Folders and files
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial-nlp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Natural Language Processing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial-intention/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The intention
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial-action/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The action
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_2_7" >
        
          
          <label class="md-nav__link" for="__nav_4_2_7" id="__nav_4_2_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    The script
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_2_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2_7">
            <span class="md-nav__icon md-icon"></span>
            The script
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial-script/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Common methods
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../widget-methods/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Widget methods
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../tutorial-packager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Packager
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" >
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            API
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API-server/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Server
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../API-client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Client
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Examples
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Examples
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developer-examples/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_4_2" id="__nav_4_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Level 1
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_4_2">
            <span class="md-nav__icon md-icon"></span>
            Level 1
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../time/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create a plugin
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_4_4_3" id="__nav_4_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Level 2
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_4_3">
            <span class="md-nav__icon md-icon"></span>
            Level 2
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../meteo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Create a widget button
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Create a window
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Create a window
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#understanding-files" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-process-file" class="md-nav__link">
    <span class="md-ellipsis">
      Main process file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preload-file" class="md-nav__link">
    <span class="md-ellipsis">
      Preload file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renderer-process-files" class="md-nav__link">
    <span class="md-ellipsis">
      Renderer process files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Renderer process files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#javascript-file" class="md-nav__link">
    <span class="md-ellipsis">
      javascript file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#html-file" class="md-nav__link">
    <span class="md-ellipsis">
      HTML file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#css" class="md-nav__link">
    <span class="md-ellipsis">
      CSS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-summarize" class="md-nav__link">
    <span class="md-ellipsis">
      To summarize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-plugin-files" class="md-nav__link">
    <span class="md-ellipsis">
      Create plugin files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create plugin files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-preload-file" class="md-nav__link">
    <span class="md-ellipsis">
      The preload file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-html-file" class="md-nav__link">
    <span class="md-ellipsis">
      The HTML file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-javacript-file" class="md-nav__link">
    <span class="md-ellipsis">
      The javacript file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-css-file" class="md-nav__link">
    <span class="md-ellipsis">
      The CSS file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-the-window" class="md-nav__link">
    <span class="md-ellipsis">
      Add the window
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Add the window">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#explanations" class="md-nav__link">
    <span class="md-ellipsis">
      Explanations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Explanations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avatarinterfacemainwindow" class="md-nav__link">
    <span class="md-ellipsis">
      Avatar.Interface.mainWindow()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-browserwindow" class="md-nav__link">
    <span class="md-ellipsis">
      class BrowserWindow #
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#winshow-event-method" class="md-nav__link">
    <span class="md-ellipsis">
      win.show() event method #
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Event methods
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#window-position" class="md-nav__link">
    <span class="md-ellipsis">
      window position
    </span>
  </a>
  
    <nav class="md-nav" aria-label="window position">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#save" class="md-nav__link">
    <span class="md-ellipsis">
      Save
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restore" class="md-nav__link">
    <span class="md-ellipsis">
      restore
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restore-window-state" class="md-nav__link">
    <span class="md-ellipsis">
      Restore window state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-weather-forecast" class="md-nav__link">
    <span class="md-ellipsis">
      Add weather forecast
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transfer-information-between-main-and-renderer-processes" class="md-nav__link">
    <span class="md-ellipsis">
      Transfer information between Main and Renderer processes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transfer information between Main and Renderer processes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type-1-send-a-message-to-the-renderer" class="md-nav__link">
    <span class="md-ellipsis">
      Type 1: Send a message to the renderer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type 1: Send a message to the renderer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contentssendchannel-args" class="md-nav__link">
    <span class="md-ellipsis">
      contents.send(channel, ...args)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ipcrendereronchannel-listener" class="md-nav__link">
    <span class="md-ellipsis">
      ipcRenderer.on(channel, listener)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-3-renderer-requests-information-from-the-main-process-and-waits-for-the-response-bidirectional" class="md-nav__link">
    <span class="md-ellipsis">
      Type 3: Renderer requests information from the main process and waits for the response (bidirectional)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type 3: Renderer requests information from the main process and waits for the response (bidirectional)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ipcmainhandlechannel-listener" class="md-nav__link">
    <span class="md-ellipsis">
      ipcMain.handle(channel, listener)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ipcrendererinvokechannel-args" class="md-nav__link">
    <span class="md-ellipsis">
      ipcRenderer.invoke(channel, ...args)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-2-renderer-sends-information-to-the-main-process-unidirectional" class="md-nav__link">
    <span class="md-ellipsis">
      Type 2: Renderer sends information to the main process (unidirectional)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type 2: Renderer sends information to the main process (unidirectional)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ipcmainonchannel-listener" class="md-nav__link">
    <span class="md-ellipsis">
      ipcMain.on(channel, listener)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ipcrenderersendchannel-args" class="md-nav__link">
    <span class="md-ellipsis">
      ipcRenderer.send(channel, ...args)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finalization" class="md-nav__link">
    <span class="md-ellipsis">
      Finalization
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../meteo-widget-client/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transfert the plugin to a client
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#understanding-files" class="md-nav__link">
    <span class="md-ellipsis">
      Understanding files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Understanding files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-process-file" class="md-nav__link">
    <span class="md-ellipsis">
      Main process file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#preload-file" class="md-nav__link">
    <span class="md-ellipsis">
      Preload file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renderer-process-files" class="md-nav__link">
    <span class="md-ellipsis">
      Renderer process files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Renderer process files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#javascript-file" class="md-nav__link">
    <span class="md-ellipsis">
      javascript file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#html-file" class="md-nav__link">
    <span class="md-ellipsis">
      HTML file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#css" class="md-nav__link">
    <span class="md-ellipsis">
      CSS
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#to-summarize" class="md-nav__link">
    <span class="md-ellipsis">
      To summarize
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#create-plugin-files" class="md-nav__link">
    <span class="md-ellipsis">
      Create plugin files
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Create plugin files">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-preload-file" class="md-nav__link">
    <span class="md-ellipsis">
      The preload file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-html-file" class="md-nav__link">
    <span class="md-ellipsis">
      The HTML file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-javacript-file" class="md-nav__link">
    <span class="md-ellipsis">
      The javacript file
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-css-file" class="md-nav__link">
    <span class="md-ellipsis">
      The CSS file
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-the-window" class="md-nav__link">
    <span class="md-ellipsis">
      Add the window
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Add the window">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#explanations" class="md-nav__link">
    <span class="md-ellipsis">
      Explanations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Explanations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#avatarinterfacemainwindow" class="md-nav__link">
    <span class="md-ellipsis">
      Avatar.Interface.mainWindow()
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-browserwindow" class="md-nav__link">
    <span class="md-ellipsis">
      class BrowserWindow #
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#winshow-event-method" class="md-nav__link">
    <span class="md-ellipsis">
      win.show() event method #
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-methods" class="md-nav__link">
    <span class="md-ellipsis">
      Event methods
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#window-position" class="md-nav__link">
    <span class="md-ellipsis">
      window position
    </span>
  </a>
  
    <nav class="md-nav" aria-label="window position">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#save" class="md-nav__link">
    <span class="md-ellipsis">
      Save
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#restore" class="md-nav__link">
    <span class="md-ellipsis">
      restore
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#restore-window-state" class="md-nav__link">
    <span class="md-ellipsis">
      Restore window state
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#add-weather-forecast" class="md-nav__link">
    <span class="md-ellipsis">
      Add weather forecast
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#transfer-information-between-main-and-renderer-processes" class="md-nav__link">
    <span class="md-ellipsis">
      Transfer information between Main and Renderer processes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Transfer information between Main and Renderer processes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#type-1-send-a-message-to-the-renderer" class="md-nav__link">
    <span class="md-ellipsis">
      Type 1: Send a message to the renderer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type 1: Send a message to the renderer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#contentssendchannel-args" class="md-nav__link">
    <span class="md-ellipsis">
      contents.send(channel, ...args)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ipcrendereronchannel-listener" class="md-nav__link">
    <span class="md-ellipsis">
      ipcRenderer.on(channel, listener)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-3-renderer-requests-information-from-the-main-process-and-waits-for-the-response-bidirectional" class="md-nav__link">
    <span class="md-ellipsis">
      Type 3: Renderer requests information from the main process and waits for the response (bidirectional)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type 3: Renderer requests information from the main process and waits for the response (bidirectional)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ipcmainhandlechannel-listener" class="md-nav__link">
    <span class="md-ellipsis">
      ipcMain.handle(channel, listener)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ipcrendererinvokechannel-args" class="md-nav__link">
    <span class="md-ellipsis">
      ipcRenderer.invoke(channel, ...args)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#type-2-renderer-sends-information-to-the-main-process-unidirectional" class="md-nav__link">
    <span class="md-ellipsis">
      Type 2: Renderer sends information to the main process (unidirectional)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Type 2: Renderer sends information to the main process (unidirectional)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ipcmainonchannel-listener" class="md-nav__link">
    <span class="md-ellipsis">
      ipcMain.on(channel, listener)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ipcrenderersendchannel-args" class="md-nav__link">
    <span class="md-ellipsis">
      ipcRenderer.send(channel, ...args)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#finalization" class="md-nav__link">
    <span class="md-ellipsis">
      Finalization
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="create-a-window">Create a window</h1>
<div class="admonition note">
<p class="admonition-title">Weather forecast plugin (part 2)</p>
<p>This example is the part 2 of a complet plugin in three parts which ultimately displays the weather forecast in a window.  </p>
<p>we'll add a window to the A.V.A.T.A.R interface built with the <a href="https://www.electronjs.org/docs/latest/">Electron</a> framework to display the weather forecast.</p>
<p>Developing a window for a plugin is made easy with A.V.A.T.A.R. You don't need to build a complete Electron application, just use the API methods. </p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that the part 1 <a href="../meteo/">Create a widget button</a> must be completed before this step.</p>
</div>
<h2 id="understanding-files">Understanding files</h2>
<p>To build a window, several files are required:</p>
<h3 id="main-process-file">Main process file</h3>
<p>The “main process” file is the plugin's node.js script file (on the web server side).<br />
All window manipulation actions, such as window creation, are performed in this file.</p>
<h3 id="preload-file">Preload file</h3>
<p>The “preload” file is a gateway between the “main process” and the “renderer process” (on the Chromium client side).<br />
This file defines the “gateway methods” that will send or receive information between the “main process” and the “renderer process” via this communication process.</p>
<h3 id="renderer-process-files">Renderer process files</h3>
<details class="info" open="open">
<summary>Important</summary>
<p>Electron rendering processes run in a sandbox.<br />
They behave in the same way as a normal Chrome rendering process. A sandboxed renderer will therefore not have an initialized Node.js environment. Simply put, you can't use node.js in a rendering process.</p>
<p>The sandbox limits the damage that malicious code can cause by restricting access to most system resources, and can only freely use CPU cycles and memory.</p>
</details>
<p>The renderer process includes 3 main files:</p>
<h4 id="javascript-file">javascript file</h4>
<p>This file receives or sends all communications from the main process (via preload) and can also perform all javascript actions on the web interface (on the Chromium client side).</p>
<details class="note" open="open">
<summary>Note</summary>
<p>There's no need for a javascript file if there's no communication between the “main process” and the “renderer process”, nor any javascript functions for the web page.</p>
</details>
<h4 id="html-file">HTML file</h4>
<p>The “html” file is the rendering file for the web page. The javascript file is called in this file.</p>
<h4 id="css">CSS</h4>
<p>The “css” file is the layout file for the web page. It is called in the “html” file.</p>
<h3 id="to-summarize">To summarize</h3>
<table>
<thead>
<tr>
<th style="text-align: left;">Type</th>
<th style="text-align: left;">SubType</th>
<th style="text-align: center;">language</th>
<th style="text-align: center;">mandatory</th>
<th style="text-align: left;">Format</th>
<th style="text-align: left;">Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">Main process</td>
<td style="text-align: left;"></td>
<td style="text-align: center;">node.js<br>&gt;= ES6</td>
<td style="text-align: center;"><strong>yes</strong></td>
<td style="text-align: left;">&lt;plugin&gt;.js</td>
<td style="text-align: left;">The plugin script</td>
</tr>
<tr>
<td style="text-align: left;">preload</td>
<td style="text-align: left;"></td>
<td style="text-align: center;">node.js<br>CommonJS</td>
<td style="text-align: center;">no</td>
<td style="text-align: left;">&lt;plugin&gt;-preload.js</td>
<td style="text-align: left;">The gateway file.<br>Mandatory only if information communication is required between the Main proccess and the Renderer process.</td>
</tr>
<tr>
<td style="text-align: left;">Renderer</td>
<td style="text-align: left;">javascript</td>
<td style="text-align: center;">&gt;= ES6</td>
<td style="text-align: center;">no</td>
<td style="text-align: left;">&lt;plugin&gt;-renderer.js</td>
<td style="text-align: left;">Mandatory only if information communication is required with the Main proccess</td>
</tr>
<tr>
<td style="text-align: left;">Renderer</td>
<td style="text-align: left;">html</td>
<td style="text-align: center;">html</td>
<td style="text-align: center;"><strong>yes</strong></td>
<td style="text-align: left;">&lt;plugin&gt;.html</td>
<td style="text-align: left;">The web page rendering file</td>
</tr>
<tr>
<td style="text-align: left;">Renderer</td>
<td style="text-align: left;">css</td>
<td style="text-align: center;">css</td>
<td style="text-align: center;">no</td>
<td style="text-align: left;">&lt;plugin&gt;.css</td>
<td style="text-align: left;">The web page layout file</td>
</tr>
</tbody>
</table>
<h2 id="create-plugin-files">Create plugin files</h2>
<h3 id="the-preload-file">The preload file</h3>
<ol>
<li>Open a terminal and navigate to the plugin folder
    <div class="highlight"><pre><span></span><code>cd &lt;A.V.A..T.A.R&gt;/resources/app/cores/plugin/weather
</code></pre></div></li>
<li>Create a <em>weather-preload.js</em> file</li>
<li>
<p>Copy the preload file template below into the file</p>
<div class="highlight"><span class="filename">weather-preload.js</span><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">contextBridge</span><span class="p">,</span><span class="w"> </span><span class="nx">ipcRenderer</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;electron&#39;</span><span class="p">)</span>

<span class="nx">contextBridge</span><span class="p">.</span><span class="nx">exposeInMainWorld</span><span class="p">(</span><span class="s1">&#39;electronAPI&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>

<span class="p">})</span>
</code></pre></div>
</li>
</ol>
<h3 id="the-html-file">The HTML file</h3>
<ol>
<li>In the plugin folder, create a <em>weather.html</em> file</li>
<li>
<p>Copy the html template below into the file</p>
<p><strong>Note:</strong> Imports of <em>weather.css</em> and <em>weather-renderer.js</em> are included.</p>
<div class="highlight"><span class="filename">weather.html</span><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;Content-Security-Policy&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;default-src &#39;self&#39;; script-src &#39;self&#39;; script-src-elem &#39;self&#39;; style-src &#39;self&#39; &#39;unsafe-inline&#39;&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;X-Content-Security-Policy&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;default-src &#39;self&#39;; script-src &#39;self&#39;&quot;</span><span class="p">/&gt;</span>
        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;./weather.css&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span> <span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>

        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;./weather-renderer.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
</li>
</ol>
<h3 id="the-javacript-file">The javacript file</h3>
<ol>
<li>In the plugin folder, create a <em>weather-renderer.js</em> file</li>
<li>For the moment, the file is empty</li>
</ol>
<h3 id="the-css-file">The CSS file</h3>
<ol>
<li>In the plugin folder, create a <em>weather.css</em> file</li>
<li>
<p>Copy the css file template below into the file</p>
<div class="highlight"><span class="filename">weather.css</span><pre><span></span><code><span class="nt">body</span><span class="o">,</span><span class="w"> </span><span class="nt">html</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">overflow</span><span class="p">:</span><span class="w"> </span><span class="kc">hidden</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="kp">-webkit-</span><span class="n">app-region</span><span class="p">:</span><span class="w"> </span><span class="n">drag</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
</li>
</ol>
<h2 id="add-the-window">Add the window</h2>
<p>In the plugin script,</p>
<ol>
<li>
<p>Add a <em>WeatherWindow</em> global variable</p>
<div class="highlight"><span class="filename">weather.js</span><pre><span></span><code><span class="hll"><span class="c1">// Private</span>
</span><span class="hll"><span class="kd">let</span><span class="w"> </span><span class="nx">WeatherWindow</span><span class="p">;</span><span class="w"> </span><span class="c1">// weather forecast window</span>
</span><span class="kd">let</span><span class="w"> </span><span class="nx">currentwidgetState</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">periphInfo</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span><span class="w"> </span><span class="c1">// devices table</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">Locale</span><span class="p">;</span><span class="w"> </span><span class="c1">//language pak</span>
</code></pre></div>
</li>
<li>
<p>Add button actions</p>
<div class="highlight"><span class="filename">weather.js</span><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">widgetAction</span><span class="w"> </span><span class="p">(</span><span class="nx">even</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Save current state</span>
<span class="w">    </span><span class="nx">currentwidgetState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">even</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">action</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;On&#39;</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// If &#39;On&#39;, show window</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">even</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">action</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;On&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">openWeatherWindow</span><span class="p">();</span>
<span class="w">    </span><span class="c1">// If &#39;Off&#39;, destroy window</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nx">even</span><span class="p">.</span><span class="nx">value</span><span class="p">.</span><span class="nx">action</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="s1">&#39;Off&#39;</span><span class="p">)</span><span class="w"> </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
</li>
<li>
<p>Add the following method to the end of the file:</p>
<div class="highlight"><table class="highlighttable"><tr><th colspan="2" class="filename"><span class="filename">weather.js</span></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">openWeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WeatherWindow</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">parent</span><span class="o">:</span><span class="w"> </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">mainWindow</span><span class="p">(),</span>
<span class="w">        </span><span class="nx">frame</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">movable</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">resizable</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">minimizable</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">alwaysOnTop</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">show</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">150</span><span class="p">,</span>
<span class="w">        </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">320</span><span class="p">,</span>
<span class="w">        </span><span class="nx">opacity</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">        </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;images&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather.png&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nx">webPreferences</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">preload</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather-preload.js&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Weather forecast&quot;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">BrowserWindow</span><span class="p">(</span><span class="nx">style</span><span class="p">,</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather.html&#39;</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>

<span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;ready-to-show&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
<span class="w">    </span><span class="p">})</span>

<span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;closed&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">})</span><span class="w">  </span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
</li>
<li>
<p>Restart A.V.A.T.A.R</p>
</li>
<li>Test the button widget <ul>
<li>You can also try moving the window using drag&amp;drop.</li>
</ul>
</li>
</ol>
<h3 id="explanations">Explanations</h3>
<p>Some explanations of the methods and objects used to create the window in the <em>openWeatherWindow</em> method </p>
<h4 id="avatarinterfacemainwindow">Avatar.Interface.mainWindow()</h4>
<p>Returns the A.V.A.T.A.R main window.<br />
Used to set the A.V.A.T.A.R main interface as parent window of the new window</p>
<div class="highlight"><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">parent</span><span class="o">:</span><span class="w"> </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">mainWindow</span><span class="p">(),</span>
<span class="w">    </span><span class="p">...</span>
</code></pre></div>
<h4 id="class-browserwindow">class BrowserWindow <a href="https://www.electronjs.org/docs/latest/api/browser-window#class-browserwindow-extends-basewindow">#</a></h4>
<p>Create and control browser windows.  </p>
<details class="warning" open="open">
<summary>Important</summary>
<p>This class is controled by A.V.A.T.A.R. You have to use the <a href="../API-server/#avatarinterfacebrowserwindowoptions-html-ismenu"><em>Avatar.Interface.BrowserWindow()</em></a> to create a new browser window.</p>
</details>
<ul>
<li>line 23: Create a new browser window
<div class="highlight"><pre><span></span><code><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">BrowserWindow</span><span class="p">(</span><span class="nx">style</span><span class="p">,</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather.html&#39;</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
</code></pre></div></li>
</ul>
<h4 id="winshow-event-method">win.show() event method <a href="https://www.electronjs.org/docs/latest/api/browser-window#winshow">#</a></h4>
<p>Shows and gives focus to the window. </p>
<ul>
<li>
<p>line 3: Creates window only if the WeatherWindow variable is undefined.
<div class="highlight"><pre><span></span><code><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WeatherWindow</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
</code></pre></div></p>
</li>
<li>
<p>line 26: Show the window when the event <code>ready-to-show</code> is emitted 
<div class="highlight"><pre><span></span><code><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;ready-to-show&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
</span><span class="p">})</span>
</code></pre></div></p>
</li>
</ul>
<h4 id="event-methods">Event methods</h4>
<p><strong>Event: 'ready-to-show' <a href="https://www.electronjs.org/docs/latest/api/browser-window#event-ready-to-show">#</a></strong><br />
Emitted when the web page has been rendered (while not being shown) and window can be displayed without a visual flash.</p>
<div class="highlight"><pre><span></span><code><span class="hll"><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;ready-to-show&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
<span class="p">})</span>
</code></pre></div>
<p><strong>Event: 'closed' <a href="https://www.electronjs.org/docs/latest/api/browser-window#event-closed">#</a></strong><br />
Emitted when the window is closed. After you have received this event you should remove the reference to the window and avoid using it any more.</p>
<div class="highlight"><pre><span></span><code><span class="hll"><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;closed&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="w">    </span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="p">})</span><span class="w">  </span>
</code></pre></div>
<h2 id="window-position">window position</h2>
<h3 id="save">Save</h3>
<p>The window position is saved when A.V.A.T.A.R is restarted or exited.</p>
<ol>
<li>
<p>Add <code>fs-extra</code> to the imports</p>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;node:path&#39;</span><span class="p">;</span>
<span class="hll"><span class="k">import</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;fs-extra&#39;</span><span class="p">;</span>
</span><span class="k">import</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">url</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;url&#39;</span><span class="p">;</span>
</code></pre></div>
</li>
<li>
<p>Add a backup test to the <em>onClose()</em> method as follows</p>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">onClose</span><span class="w"> </span><span class="p">(</span><span class="nx">widgets</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Save widget position</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Config</span><span class="p">.</span><span class="nx">modules</span><span class="p">.</span><span class="nx">weather</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="kc">true</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">await</span><span class="w"> </span><span class="nx">Widget</span><span class="p">.</span><span class="nx">initVar</span><span class="p">(</span><span class="nx">widgetFolder</span><span class="p">,</span><span class="w"> </span><span class="nx">widgetImgFolder</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="nx">Config</span><span class="p">.</span><span class="nx">modules</span><span class="p">.</span><span class="nx">weather</span><span class="p">);</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">widgets</span><span class="p">)</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">Widget</span><span class="p">.</span><span class="nx">saveWidgets</span><span class="p">(</span><span class="nx">widgets</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="hll"><span class="w">    </span><span class="c1">// Save meteo forecast position</span>
</span><span class="hll"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WeatherWindow</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="c1">// The window is displayed</span>
</span><span class="hll"><span class="w">        </span><span class="c1">// Get window instance position</span>
</span><span class="hll"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">pos</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">getPosition</span><span class="p">();</span>
</span><span class="hll"><span class="w">        </span><span class="c1">// Writes position and the window state (displayed or closed)</span>
</span><span class="hll"><span class="w">        </span><span class="nx">fs</span><span class="p">.</span><span class="nx">writeJsonSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">        </span><span class="nx">x</span><span class="o">:</span><span class="w"> </span><span class="nx">pos</span><span class="p">[</span><span class="mf">0</span><span class="p">],</span>
</span><span class="hll"><span class="w">        </span><span class="nx">y</span><span class="o">:</span><span class="w"> </span><span class="nx">pos</span><span class="p">[</span><span class="mf">1</span><span class="p">],</span>
</span><span class="hll"><span class="w">        </span><span class="nx">start</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
</span><span class="hll"><span class="w">        </span><span class="p">});</span>
</span><span class="hll"><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">  </span><span class="c1">// The window is closed</span>
</span><span class="hll"><span class="w">        </span><span class="c1">// If the backup file exists then keeps the position first</span>
</span><span class="hll"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{};</span>
</span><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">            </span><span class="nx">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readJsonSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">throws</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">});</span>
</span><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><span class="hll"><span class="w">        </span><span class="c1">// Writes the window state (closed)</span>
</span><span class="hll"><span class="w">        </span><span class="nx">prop</span><span class="p">.</span><span class="nx">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span class="hll"><span class="w">        </span><span class="nx">fs</span><span class="p">.</span><span class="nx">writeJsonSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">),</span><span class="w"> </span><span class="nx">prop</span><span class="p">);</span>
</span><span class="hll"><span class="w">    </span><span class="p">}</span>
</span><span class="p">}</span><span class="w"> </span>
</code></pre></div>
</li>
</ol>
<h3 id="restore">restore</h3>
<p>The window position is restored when the window is created.</p>
<ol>
<li>
<p>Add the position feedback to the <em>openWeatherWindow()</em> method as follows</p>
<div class="highlight"><span class="filename">weather.js</span><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">openWeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WeatherWindow</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">parent</span><span class="o">:</span><span class="w"> </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">mainWindow</span><span class="p">(),</span>
<span class="w">        </span><span class="nx">frame</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">movable</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">resizable</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">minimizable</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">alwaysOnTop</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">show</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">150</span><span class="p">,</span>
<span class="w">        </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">320</span><span class="p">,</span>
<span class="w">        </span><span class="nx">opacity</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">        </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;images&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather.png&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nx">webPreferences</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">preload</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather-preload.js&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Weather forecast&quot;</span>
<span class="w">    </span><span class="p">};</span>

<span class="hll"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readJsonSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">throws</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">});</span>
</span><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">prop</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">            </span><span class="nx">style</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prop</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
</span><span class="hll"><span class="w">            </span><span class="nx">style</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prop</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
</span><span class="hll"><span class="w">        </span><span class="p">}</span>
</span><span class="hll"><span class="w">    </span><span class="p">}</span>
</span>
<span class="w">    </span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">BrowserWindow</span><span class="p">(</span><span class="nx">style</span><span class="p">,</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather.html&#39;</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>

<span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;ready-to-show&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
<span class="w">    </span><span class="p">})</span>

<span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;closed&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">})</span><span class="w">  </span>
<span class="p">}</span>
</code></pre></div>
</li>
</ol>
<h2 id="restore-window-state">Restore window state</h2>
<p>The window state is restored when A.V.A.T.A.R has finished displaying widgets.</p>
<ol>
<li>
<p>In the <em>readyToShow()</em> method, add a status display as follows</p>
<p><div class="highlight"><span class="filename">weather.js</span><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">readyToShow</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">    </span><span class="c1">// If a backup file exists</span>
</span><span class="hll"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readJsonSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">throws</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">});</span>
</span><span class="hll"><span class="w">        </span><span class="c1">// Set currentwidgetState global variable</span>
</span><span class="hll"><span class="w">        </span><span class="nx">currentwidgetState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prop</span><span class="p">.</span><span class="nx">start</span><span class="p">;</span>
</span><span class="hll"><span class="w">        </span><span class="c1">// currentwidgetState = true : creates and shows new window</span>
</span><span class="hll"><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">currentwidgetState</span><span class="p">)</span><span class="w"> </span><span class="nx">openWeatherWindow</span><span class="p">();</span>
</span><span class="hll"><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w">  </span>
</span><span class="hll"><span class="w">        </span><span class="c1">// not displayed if the window is closed</span>
</span><span class="hll"><span class="w">        </span><span class="nx">currentwidgetState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span class="hll">
</span><span class="hll"><span class="w">    </span><span class="c1">// Refreshs information of the button widget regarding window state (&#39;On&#39; or &#39;Off&#39; image)</span>
</span><span class="hll"><span class="w">    </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">refreshWidgetInfo</span><span class="p">({</span><span class="nx">plugin</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;weather&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;808221&quot;</span><span class="p">});</span><span class="w">  </span>
</span><span class="p">}</span>
</code></pre></div>
2. Reset the currentwidgetState variable to <code>false</code> in the <code>closed</code> event, as shown below</p>
<div class="highlight"><span class="filename">weather.js</span><pre><span></span><code><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;closed&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">    </span><span class="c1">// not displayed if the window is closed</span>
</span><span class="hll"><span class="w">    </span><span class="nx">currentwidgetState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span>
<span class="w">    </span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="p">})</span><span class="w">  </span>
</code></pre></div>
</li>
<li>
<p>Restart A.V.A.T.A.R</p>
</li>
<li>Test save/restore window position and status </li>
</ol>
<h2 id="add-weather-forecast">Add weather forecast</h2>
<p>You can retrieve a city weather widget from several sites. Be careful which site you choose, as some sites collect a lot of connection information (like weatherwidget.org), while others are listed as very dangerous (like widget-meteo.com). The easiest way is to use a secure site (such as <a href="https://meteofrance.com/widgets">météo France</a>, which also provides weather information for all countries).</p>
<details class="warning" open="open">
<summary>Warning</summary>
<p>Remember also the creation of the html file. This file, created by rendering in the sandbox, limits the damage that malicious code can cause, but also requires validation of external links. For some sites that execute javascript code, you'll need to authorize the site in the <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Security-Policy/script-src">security policy</a>.</p>
</details>
<ol>
<li>Open a browser and connect to the <a href="https://meteofrance.com/widgets">météo France</a> website or the website of your choice.</li>
<li>Get the html code</li>
<li>
<p>Copy it into the html file as follows</p>
<p><div class="highlight"><span class="filename">weather.html</span><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;Content-Security-Policy&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;script-src &#39;self&#39;; script-src-elem &#39;self&#39;; style-src &#39;self&#39; &#39;unsafe-inline&#39;&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;X-Content-Security-Policy&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;default-src &#39;self&#39;; script-src &#39;self&#39;&quot;</span><span class="p">/&gt;</span>
        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;./weather.css&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span> <span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="hll">        <span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;widget_autocomplete_preview&quot;</span>  <span class="na">width</span><span class="o">=</span><span class="s">&quot;150&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;300&quot;</span> <span class="na">frameborder</span><span class="o">=</span><span class="s">&quot;0&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://meteofrance.com/widget/prevision/441090##3D6AA2&quot;</span> <span class="na">title</span><span class="o">=</span><span class="s">&quot;Prévisions Nantes par Météo-France&quot;</span><span class="p">&gt;</span> <span class="p">&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</span>        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;./weather-renderer.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
4. Change the size of the <em>iframe</em> element to width=“100%” and height=“100%”.</p>
<p><div class="highlight"><span class="filename">weather.html</span><pre><span></span><code><span class="hll"><span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;widget_autocomplete_preview&quot;</span>  <span class="na">width</span><span class="o">=</span><span class="s">&quot;100%&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;100%&quot;</span> <span class="na">frameborder</span><span class="o">=</span><span class="s">&quot;0&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://meteofrance.com/widget/prevision/441090##3D6AA2&quot;</span> <span class="na">title</span><span class="o">=</span><span class="s">&quot;Prévisions Nantes par Météo-France&quot;</span><span class="p">&gt;</span> <span class="p">&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</span></code></pre></div>
5. Authorize the site in the security policy by adding it to the <code>default-src</code> font as follows
<div class="highlight"><span class="filename">weather.html</span><pre><span></span><code><span class="hll"><span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;Content-Security-Policy&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;default-src &#39;self&#39; https://meteofrance.com; script-src &#39;self&#39;; script-src-elem &#39;self&#39;; style-src &#39;self&#39; &#39;unsafe-inline&#39;&quot;</span><span class="p">&gt;</span>
</span></code></pre></div>
6. Restart A.V.A.T.A.R</p>
<p><img alt="meteo-displayed" src="../img/meteo-displayed.png" width="250" /></p>
</li>
</ol>
<details class="tip" open="open">
<summary>Tip</summary>
<p>If you notice a problem with window size, you can adjust it in the script and the <em>style.width</em> and <em>style.height</em> objects.</p>
</details>
<h2 id="transfer-information-between-main-and-renderer-processes">Transfer information between Main and Renderer processes</h2>
<p>We could stop here, since the plugin is already functional, but for the purposes of this example, we're going to transfer information between the main process and the renderer process.</p>
<p>There are several types of Inter-Process Communication (IPC):</p>
<p><strong>Type 1:</strong> Main process to renderer<br />
<strong>Type 2:</strong> Renderer to main process (unidirectional)<br />
<strong>Type 3:</strong> Renderer to main process (bidirectional)</p>
<details class="tip" open="open">
<summary>Tip</summary>
<p>To familiarize yourself with these concepts, you can read Electron's documentation on <a href="https://www.electronjs.org/fr/docs/latest/tutorial/ipc">Inter-process communication</a>.</p>
</details>
<p>In our example, we'll first use type 1 to send a message from the main process to the renderer to execute a function, then type 3 for the renderer to request information from the main process and receive a response, and finally type 2 for the renderer to send an execution command to close the window to the main process.</p>
<h3 id="type-1-send-a-message-to-the-renderer">Type 1: Send a message to the renderer</h3>
<p>Sending a message to the rendering engine is done via its <a href="https://www.electronjs.org/fr/docs/latest/api/web-contents">WebContents</a> instance. This WebContents instance contains a <a href="https://www.electronjs.org/fr/docs/latest/api/web-contents#contentssendchannel-args">send</a> method that can be used.</p>
<ol>
<li>
<p>Add the <code>send</code> method</p>
<h4 id="contentssendchannel-args">contents.send(channel, ...args)</h4>
<ul>
<li>channel string</li>
<li>...args any[]</li>
</ul>
<p>Sends an asynchronous message and a number of arguments to the renderer process via channel</p>
<details class="warning">
<summary>Warning</summary>
<p>NOTE: Sending non-standard Javascript types such as DOM objects or special objects will trigger an exception.</p>
</details>
<p>For our example, we need to tell the renderer to execute an update action on a <code>label</code> element <strong>after</strong> its complete initialization (so that all DOM elements are accessible). The way to do this is to place the <code>send</code> method in the <code>ready-to-show</code> event.</p>
<div class="highlight"><span class="filename">weather.js</span><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">openWeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WeatherWindow</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">parent</span><span class="o">:</span><span class="w"> </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">mainWindow</span><span class="p">(),</span>
<span class="w">        </span><span class="nx">frame</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">movable</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">resizable</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">minimizable</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">alwaysOnTop</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">show</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">150</span><span class="p">,</span>
<span class="w">        </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">320</span><span class="p">,</span>
<span class="w">        </span><span class="nx">opacity</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">        </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;images&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather.png&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nx">webPreferences</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">preload</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather-preload.js&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Weather forecast&quot;</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readJsonSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">throws</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">});</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">prop</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">style</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prop</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
<span class="w">            </span><span class="nx">style</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prop</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">BrowserWindow</span><span class="p">(</span><span class="nx">style</span><span class="p">,</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather.html&#39;</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>

<span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;ready-to-show&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
<span class="hll"><span class="w">         </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">webContents</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;onInit-weather&#39;</span><span class="p">);</span>
</span><span class="w">    </span><span class="p">})</span>

<span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;closed&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// not displayed if the window is closed</span>
<span class="w">        </span><span class="nx">currentwidgetState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">        </span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">})</span><span class="w">  </span>
<span class="p">}</span><span class="w"> </span>
</code></pre></div>
</li>
<li>
<p>Exposure of <code>ipcRenderer.on</code> by adding it to the preload script</p>
<h4 id="ipcrendereronchannel-listener">ipcRenderer.on(channel, listener)</h4>
<ul>
<li>channel string</li>
<li>listener Function<ul>
<li>event IpcRendererEvent</li>
<li>...args any[]</li>
</ul>
</li>
</ul>
<p>Listen on channel and listener will be called as follows: listener(event, args...) when a new message is received.</p>
<div class="highlight"><span class="filename">weather-preload.js</span><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">contextBridge</span><span class="p">,</span><span class="w"> </span><span class="nx">ipcRenderer</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;electron&#39;</span><span class="p">)</span>

<span class="nx">contextBridge</span><span class="p">.</span><span class="nx">exposeInMainWorld</span><span class="p">(</span><span class="s1">&#39;electronAPI&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">    </span><span class="nx">onInitWeather</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">ipcRenderer</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;onInit-weather&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">_event</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">callback</span><span class="p">(</span><span class="nx">value</span><span class="p">))</span>
</span><span class="p">})</span><span class="w">    </span>
</code></pre></div>
<p>After loading the preload script, your renderer process will have access to the listen function <code>window.electronAPI.onInitWeather()</code>.</p>
</li>
<li>
<p>Add the listening function to the rendering engine</p>
<div class="highlight"><span class="filename">weather-renderer.js</span><pre><span></span><code><span class="c1">// Update element function</span>
<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">setElementLabel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="p">}</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">electronAPI</span><span class="p">.</span><span class="nx">onInitWeather</span><span class="p">(</span><span class="w"> </span><span class="nx">_event</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Update element on init</span>
<span class="w">    </span><span class="nx">setElementLabel</span><span class="p">();</span>
<span class="p">})</span>
</code></pre></div>
</li>
</ol>
<p><strong>To summarize</strong><br />
We sent a message to the renderer using the <code>send</code> method via the <code>ipcRenderer.on</code> preload script, and the renderer receives it via the <code>onInitWeather</code> listen function.</p>
<p>Now we need to request the value of a <code>label</code> element. To do this, we'll establish a type 3 communication: from the renderer to the main process (bidirectional).</p>
<h3 id="type-3-renderer-requests-information-from-the-main-process-and-waits-for-the-response-bidirectional">Type 3: Renderer requests information from the main process and waits for the response (bidirectional)</h3>
<p>Bidirectional communication is the calling of a main process module from the renderer process code with the expectation of a result. This can be done using <a href="https://www.electronjs.org/fr/docs/latest/api/ipc-renderer#ipcrendererinvokechannel-args">ipcRenderer.invoke</a> in the preload script paired with <a href="https://www.electronjs.org/fr/docs/latest/api/ipc-main#ipcmainhandlechannel-listener">ipcMain.handle</a> in the main process.</p>
<ol>
<li>
<p>Add a listener module</p>
<h4 id="ipcmainhandlechannel-listener">ipcMain.handle(channel, listener)</h4>
<ul>
<li>channel string</li>
<li>listener Function<Promise\<any> | any><ul>
<li>event IpcMainInvokeEvent</li>
<li>...args any[]</li>
</ul>
</li>
</ul>
<p>Adds a listening module to <em>channel</em> in the main process. This handler is called whenever the rendering process calls <code>ipcRenderer.invoke(channel, ...args)</code>.</p>
<p>If listener returns a Promise, the final result of the promise will be returned in response to the remote caller. Otherwise, the listener's return value will be used as the response value.</p>
<details class="warning" open="open">
<summary>Warning</summary>
<ul>
<li>The IPC main is controled by A.V.A.T.A.R. You have to use the <a href="../API-server/#avatarinterfaceipcmain"><em>Avatar.Interface.ipcMain()</em></a> for returning the A.V.A.T.A.R ipcMain.</li>
<li>A <em>channel</em> handle can only be declared once. It must <strong>obligatorily</strong> be removed by an <a href="https://www.electronjs.org/fr/docs/latest/api/ipc-main#ipcmainremovehandlerchannel">ipcMain.removeHandler</a> before being declared again.</li>
</ul>
</details>
<ul>
<li>Add and remove the handler in the <em>openWeatherWindow</em> method as follows</li>
</ul>
<div class="highlight"><span class="filename">weather.js</span><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">openWeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WeatherWindow</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">parent</span><span class="o">:</span><span class="w"> </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">mainWindow</span><span class="p">(),</span>
<span class="w">        </span><span class="nx">frame</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">movable</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">resizable</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">minimizable</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">alwaysOnTop</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">show</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">150</span><span class="p">,</span>
<span class="w">        </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">320</span><span class="p">,</span>
<span class="w">        </span><span class="nx">opacity</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">        </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;images&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather.png&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nx">webPreferences</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">preload</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather-preload.js&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Weather forecast&quot;</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readJsonSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">throws</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">});</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">prop</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">style</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prop</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
<span class="w">            </span><span class="nx">style</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prop</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">BrowserWindow</span><span class="p">(</span><span class="nx">style</span><span class="p">,</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather.html&#39;</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>

<span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;ready-to-show&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
<span class="w">        </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">webContents</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;onInit-weather&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">})</span>

<span class="hll"><span class="w">    </span><span class="c1">// returns the localized message defined in arg</span>
</span><span class="hll"><span class="w">    </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">ipcMain</span><span class="p">().</span><span class="nx">handle</span><span class="p">(</span><span class="s1">&#39;weather-msg&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">_event</span><span class="p">,</span><span class="w"> </span><span class="nx">arg</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="nx">Locale</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">arg</span><span class="p">)});</span>
</span>
<span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;closed&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// not displayed if the window is closed</span>
<span class="w">        </span><span class="nx">currentwidgetState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="hll"><span class="w">        </span><span class="c1">// Removes the `weather-msg` handler when the window is closed</span>
</span><span class="hll"><span class="w">        </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">ipcMain</span><span class="p">().</span><span class="nx">removeHandler</span><span class="p">(</span><span class="s1">&#39;weather-msg&#39;</span><span class="p">);</span>
</span>
<span class="w">        </span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">})</span><span class="w">  </span>
<span class="p">}</span>
</code></pre></div>
</li>
<li>
<p>Exposing <code>ipcRenderer.invoke</code> by adding it to the preload script</p>
<h4 id="ipcrendererinvokechannel-args">ipcRenderer.invoke(channel, ...args)</h4>
<ul>
<li>channel string</li>
<li>...args any[]</li>
</ul>
<p>Returns a Promise<any> - which resolves with the response from the main process.</p>
<p>Sends a message to the main process via channel and waits for an asynchronous result.</p>
<div class="highlight"><span class="filename">weather-preload.js</span><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">contextBridge</span><span class="p">,</span><span class="w"> </span><span class="nx">ipcRenderer</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;electron&#39;</span><span class="p">)</span>

<span class="nx">contextBridge</span><span class="p">.</span><span class="nx">exposeInMainWorld</span><span class="p">(</span><span class="s1">&#39;electronAPI&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">onInitWeather</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">ipcRenderer</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;onInit-weather&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">_event</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">callback</span><span class="p">(</span><span class="nx">value</span><span class="p">)),</span>
<span class="hll"><span class="w">    </span><span class="nx">getMsg</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">ipcRenderer</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="s1">&#39;weather-msg&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">)</span>
</span><span class="p">})</span><span class="w">    </span>
</code></pre></div>
<p>The <code>weather-msg</code> listening module is called whenever the renderer's <code>window.electronAPI.getMsg()</code> function calls <code>ipcRenderer.invoke()</code>. </p>
</li>
<li>
<p>Add the <em>getMsg()</em> function to the renderer process</p>
<div class="highlight"><span class="filename">weather-renderer.js</span><pre><span></span><code><span class="hll"><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Lget</span><span class="w"> </span><span class="p">(</span><span class="nx">target</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">        </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nx">target</span><span class="p">];</span>
</span><span class="hll"><span class="w">        </span><span class="nx">args</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">arg</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">            </span><span class="nx">target</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arg</span><span class="p">);</span>
</span><span class="hll"><span class="w">        </span><span class="p">})</span>
</span><span class="hll"><span class="w">    </span><span class="p">}</span><span class="w"> </span>
</span><span class="hll">
</span><span class="hll"><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">electronAPI</span><span class="p">.</span><span class="nx">getMsg</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
</span><span class="hll"><span class="p">}</span>
</span>
<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">setElementLabel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="hll"><span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;quit&#39;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">Lget</span><span class="p">(</span><span class="s2">&quot;message.quit&quot;</span><span class="p">);</span>
</span><span class="p">}</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">electronAPI</span><span class="p">.</span><span class="nx">onInitWeather</span><span class="p">(</span><span class="w"> </span><span class="nx">_event</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setElementLabel</span><span class="p">();</span><span class="w"> </span>
<span class="p">})</span><span class="w">  </span>
</code></pre></div>
</li>
<li>
<p>Localize the message</p>
<ul>
<li>Modify the <em>weather/locales/en.pak</em> file as follows</li>
</ul>
<p><strong>NOTE:</strong> See <a href="../API-server/#lang-pakgetkey"><em>&lt;lang&gt;.get()</em></a> for futher information.</p>
<div class="highlight"><span class="filename">en.pak</span><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;message&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;quit&quot;</span><span class="p">:</span><span class="s2">&quot;X&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
</li>
<li>
<p>Add a <code>label</code> element to the html file</p>
<p><div class="highlight"><span class="filename">weather.html</span><pre><span></span><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="p">&lt;</span><span class="nt">html</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">head</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">charset</span><span class="o">=</span><span class="s">&quot;UTF-8&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;Content-Security-Policy&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;script-src &#39;self&#39;; script-src-elem &#39;self&#39;; style-src &#39;self&#39; &#39;unsafe-inline&#39;&quot;</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">meta</span> <span class="na">http-equiv</span><span class="o">=</span><span class="s">&quot;X-Content-Security-Policy&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;default-src &#39;self&#39;; script-src &#39;self&#39;&quot;</span><span class="p">/&gt;</span>
        <span class="p">&lt;</span><span class="nt">link</span> <span class="na">href</span><span class="o">=</span><span class="s">&quot;./weather.css&quot;</span> <span class="na">rel</span><span class="o">=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;text/css&quot;</span> <span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nt">head</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">body</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;widget_autocomplete_preview&quot;</span>  <span class="na">width</span><span class="o">=</span><span class="s">&quot;150&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;300&quot;</span> <span class="na">frameborder</span><span class="o">=</span><span class="s">&quot;0&quot;</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;https://meteofrance.com/widget/prevision/441090##3D6AA2&quot;</span> <span class="na">title</span><span class="o">=</span><span class="s">&quot;Prévisions Nantes par Météo-France&quot;</span><span class="p">&gt;</span> <span class="p">&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
<span class="hll">        <span class="p">&lt;</span><span class="nt">label</span> <span class="na">id</span><span class="o">=</span><span class="s">&quot;quit&quot;</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;quit&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">label</span><span class="p">&gt;</span>
</span>        <span class="p">&lt;</span><span class="nt">script</span> <span class="na">src</span><span class="o">=</span><span class="s">&quot;./weather-renderer.js&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">body</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">html</span><span class="p">&gt;</span>
</code></pre></div>
6. Add a style to the css file</p>
<div class="highlight"><span class="filename">weather.css</span><pre><span></span><code><span class="nt">body</span><span class="o">,</span><span class="w"> </span><span class="nt">html</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">width</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">height</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="kt">%</span><span class="p">;</span>
<span class="w">    </span><span class="k">overflow</span><span class="p">:</span><span class="w"> </span><span class="kc">hidden</span><span class="p">;</span>
<span class="w">    </span><span class="k">margin</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">    </span><span class="kp">-webkit-</span><span class="n">app-region</span><span class="p">:</span><span class="w"> </span><span class="n">drag</span><span class="p">;</span>
<span class="p">}</span>

<span class="hll"><span class="p">.</span><span class="nc">quit</span><span class="p">{</span>
</span><span class="hll"><span class="w">    </span><span class="k">position</span><span class="p">:</span><span class="w"> </span><span class="kc">fixed</span><span class="p">;</span>
</span><span class="hll"><span class="w">    </span><span class="k">top</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="kt">px</span><span class="p">;</span>
</span><span class="hll"><span class="w">    </span><span class="k">right</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="kt">px</span><span class="p">;</span>
</span><span class="hll"><span class="w">    </span><span class="kp">-webkit-</span><span class="n">app-region</span><span class="p">:</span><span class="n">no-drag</span><span class="p">;</span>
</span><span class="hll"><span class="w">    </span><span class="k">font</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="kt">px</span><span class="w"> </span><span class="n">helvetica</span><span class="w"> </span><span class="n">neue</span><span class="p">,</span><span class="w"> </span><span class="n">helvetica</span><span class="p">,</span><span class="w"> </span><span class="n">arial</span><span class="p">,</span><span class="w"> </span><span class="kc">sans-serif</span><span class="p">;</span>
</span><span class="hll"><span class="w">    </span><span class="k">font-weight</span><span class="p">:</span><span class="w"> </span><span class="kc">bold</span><span class="p">;</span>
</span><span class="hll"><span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="nb">rgb</span><span class="p">(</span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">);</span>
</span><span class="hll"><span class="w">    </span><span class="k">z-index</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
</span><span class="hll"><span class="p">}</span>
</span><span class="hll"><span class="p">.</span><span class="nc">quit</span><span class="p">:</span><span class="nd">hover</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">    </span><span class="k">color</span><span class="p">:</span><span class="w"> </span><span class="nb">rgb</span><span class="p">(</span><span class="mi">247</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">);</span>
</span><span class="hll"><span class="w">    </span><span class="k">cursor</span><span class="p">:</span><span class="w"> </span><span class="kc">pointer</span><span class="p">;</span>
</span><span class="hll"><span class="p">}</span>
</span></code></pre></div>
</li>
<li>
<p>Restart A.V.A.T.A.R and check the addition of the <strong>X</strong> label element in the top right-hand corner.</p>
<p><img alt="meteo-displayed-X" src="../img/meteo-displayed-X.png" width="150" /></p>
</li>
</ol>
<h3 id="type-2-renderer-sends-information-to-the-main-process-unidirectional">Type 2: Renderer sends information to the main process (unidirectional)</h3>
<p>One-way communication is the calling of a main process module from the rendering process code. This can be done using <a href="https://www.electronjs.org/fr/docs/latest/api/ipc-renderer#ipcrendererinvokechannel-args">ipcRenderer.send</a> in the preload script paired with <a href="https://www.electronjs.org/fr/docs/latest/api/ipc-main#ipcmainonchannel-listener">ipcMain.on</a> in the main process.</p>
<ol>
<li>
<p>Add a listening module</p>
<h4 id="ipcmainonchannel-listener">ipcMain.on(channel, listener)</h4>
<ul>
<li>channel string</li>
<li>listener Function<ul>
<li>event IpcMainEvent</li>
<li>...args any[]</li>
</ul>
</li>
</ul>
<p>Listen on channel and listener will be called as follows: listener(event, args...) when a new message is received.</p>
<details class="warning" open="open">
<summary>Warning</summary>
<ul>
<li>The IPC main is controled by A.V.A.T.A.R. You have to use the <a href=""><em>Avatar.Interface.ipcMain()</em></a> for returning the A.V.A.T.A.R ipcMain.</li>
<li>A Listener for the <em>channel</em> can only be declared once. It must <strong>obligatorily</strong> be removed by a <a href="https://www.electronjs.org/fr/docs/latest/api/ipc-main#ipcmainremovealllistenerschannel">ipcMain.removeAllListeners</a> before being declared again.</li>
</ul>
</details>
<p>For our example, we need to tell the main process to close the window by clicking on the <strong>X</strong> label element.  </p>
<p><strong>NOTE:</strong> This closure is performed by the instance method <a href="https://www.electronjs.org/fr/docs/latest/api/base-window#windestroy"><em>win.destroy()</em></a></p>
<ul>
<li>Add the listening module and a remove in the <em>openWeatherWindow</em> method as follows</li>
</ul>
<div class="highlight"><span class="filename">weather.js</span><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="nx">openWeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">WeatherWindow</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">parent</span><span class="o">:</span><span class="w"> </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">mainWindow</span><span class="p">(),</span>
<span class="w">        </span><span class="nx">frame</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">movable</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">resizable</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">minimizable</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">alwaysOnTop</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">show</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="mf">150</span><span class="p">,</span>
<span class="w">        </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="mf">320</span><span class="p">,</span>
<span class="w">        </span><span class="nx">opacity</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span>
<span class="w">        </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;images&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather.png&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nx">webPreferences</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">preload</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather-preload.js&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Weather forecast&quot;</span>
<span class="w">    </span><span class="p">};</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">fs</span><span class="p">.</span><span class="nx">existsSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">)))</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kd">let</span><span class="w"> </span><span class="nx">prop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">fs</span><span class="p">.</span><span class="nx">readJsonSync</span><span class="p">(</span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;style.json&#39;</span><span class="p">),</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="kr">throws</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">});</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">prop</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">style</span><span class="p">.</span><span class="nx">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prop</span><span class="p">.</span><span class="nx">x</span><span class="p">;</span>
<span class="w">            </span><span class="nx">style</span><span class="p">.</span><span class="nx">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">prop</span><span class="p">.</span><span class="nx">y</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">BrowserWindow</span><span class="p">(</span><span class="nx">style</span><span class="p">,</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather.html&#39;</span><span class="p">),</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>

<span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;ready-to-show&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
<span class="w">        </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">webContents</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;onInit-weather&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="p">})</span>

<span class="hll"><span class="w">    </span><span class="c1">// Destroys window by a click on the &#39;X&#39; label </span>
</span><span class="hll"><span class="w">    </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">ipcMain</span><span class="p">().</span><span class="nx">one</span><span class="p">(</span><span class="s1">&#39;weather-quit&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">        </span><span class="c1">// Closed window</span>
</span><span class="hll"><span class="w">        </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
</span><span class="hll">
</span><span class="hll"><span class="w">        </span><span class="c1">// refresh widget button on window closed</span>
</span><span class="hll"><span class="w">        </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">refreshWidgetInfo</span><span class="p">({</span><span class="nx">plugin</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;weather&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;808221&quot;</span><span class="p">});</span>
</span><span class="hll"><span class="w">    </span><span class="p">});</span>
</span>
<span class="w">    </span><span class="c1">// returns the localized message defined in arg</span>
<span class="w">    </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">ipcMain</span><span class="p">().</span><span class="nx">handle</span><span class="p">(</span><span class="s1">&#39;weather-msg&#39;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">_event</span><span class="p">,</span><span class="w"> </span><span class="nx">arg</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span><span class="k">return</span><span class="w"> </span><span class="nx">Locale</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="nx">arg</span><span class="p">)});</span>

<span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;closed&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="c1">// not displayed if the window is closed</span>
<span class="w">        </span><span class="nx">currentwidgetState</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>

<span class="w">        </span><span class="c1">// Removes the `weather-msg` handler when the window is closed</span>
<span class="w">        </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">ipcMain</span><span class="p">().</span><span class="nx">removeHandler</span><span class="p">(</span><span class="s1">&#39;weather-msg&#39;</span><span class="p">);</span>

<span class="hll"><span class="w">        </span><span class="c1">// Removes the `weather-quit` listener when the window is closed</span>
</span><span class="hll"><span class="w">        </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">ipcMain</span><span class="p">().</span><span class="nx">removeAllListeners</span><span class="p">(</span><span class="s1">&#39;weather-quit&#39;</span><span class="p">);</span>
</span>
<span class="w">        </span><span class="nx">WeatherWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">    </span><span class="p">})</span><span class="w">  </span>
<span class="p">}</span>
</code></pre></div>
</li>
<li>
<p>Exposure of <code>ipcRenderer.send</code> by adding it to the preload script</p>
<h4 id="ipcrenderersendchannel-args">ipcRenderer.send(channel, ...args)</h4>
<ul>
<li>channel string</li>
<li>...args any[]</li>
</ul>
<p>Sends an asynchronous message and arguments to the main process via channel.</p>
<div class="highlight"><span class="filename">weather-preload.js</span><pre><span></span><code><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">contextBridge</span><span class="p">,</span><span class="w"> </span><span class="nx">ipcRenderer</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;electron&#39;</span><span class="p">)</span>

<span class="nx">contextBridge</span><span class="p">.</span><span class="nx">exposeInMainWorld</span><span class="p">(</span><span class="s1">&#39;electronAPI&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">onInitWeather</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">callback</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">ipcRenderer</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;onInit-weather&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="nx">_event</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">callback</span><span class="p">(</span><span class="nx">value</span><span class="p">)),</span>
<span class="w">    </span><span class="nx">getMsg</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="nx">value</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">ipcRenderer</span><span class="p">.</span><span class="nx">invoke</span><span class="p">(</span><span class="s1">&#39;weather-msg&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">),</span>
<span class="hll"><span class="w">    </span><span class="nx">quit</span><span class="o">:</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">ipcRenderer</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;weather-quit&#39;</span><span class="p">)</span>
</span><span class="p">})</span><span class="w">    </span>
</code></pre></div>
<p>The <code>weather-quit</code> listener is called whenever the <code>window.electronAPI.quit()</code> function of the rendering process calls <code>ipcRenderer.send()</code>.</p>
</li>
<li>
<p>Add the <code>window.electronAPI.quit()</code> function to the renderer process</p>
<div class="highlight"><span class="filename">weather-renderer.js</span><pre><span></span><code><span class="hll"><span class="nb">window</span><span class="p">.</span><span class="nx">onbeforeunload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">e</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">    </span><span class="nx">e</span><span class="p">.</span><span class="nx">returnValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
</span><span class="hll"><span class="w">    </span><span class="c1">// Calls window closure in the main process </span>
</span><span class="hll"><span class="w">    </span><span class="nb">window</span><span class="p">.</span><span class="nx">electronAPI</span><span class="p">.</span><span class="nx">quit</span><span class="p">();</span>
</span><span class="hll"><span class="p">}</span>
</span><span class="hll">
</span><span class="hll"><span class="c1">// A click on the label calls the &#39;beforeunload&#39; event</span>
</span><span class="hll"><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s2">&quot;quit&quot;</span><span class="p">).</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="p">(</span><span class="nx">event</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span class="hll"><span class="w">    </span><span class="nb">window</span><span class="p">.</span><span class="nx">dispatchEvent</span><span class="p">(</span><span class="ow">new</span><span class="w"> </span><span class="nx">Event</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;beforeunload&#39;</span><span class="p">));</span>
</span><span class="hll"><span class="p">})</span>
</span>
<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">Lget</span><span class="w"> </span><span class="p">(</span><span class="nx">target</span><span class="p">,</span><span class="w"> </span><span class="p">...</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nx">target</span><span class="p">];</span>
<span class="w">        </span><span class="nx">args</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">arg</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="nx">target</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">arg</span><span class="p">);</span>
<span class="w">        </span><span class="p">})</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nb">window</span><span class="p">.</span><span class="nx">electronAPI</span><span class="p">.</span><span class="nx">getMsg</span><span class="p">(</span><span class="nx">target</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">setElementLabel</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;quit&#39;</span><span class="p">).</span><span class="nx">innerHTML</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">Lget</span><span class="p">(</span><span class="s2">&quot;message.quit&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="nb">window</span><span class="p">.</span><span class="nx">electronAPI</span><span class="p">.</span><span class="nx">onInitWeather</span><span class="p">(</span><span class="w"> </span><span class="nx">_event</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">setElementLabel</span><span class="p">();</span><span class="w"> </span>
<span class="p">})</span>
</code></pre></div>
</li>
<li>
<p>Restart A.V.A.T.A.R and check that the window is closed by clicking on the <strong>X</strong> label element.</p>
</li>
</ol>
<h2 id="finalization">Finalization</h2>
<p>A few small additions to finalize the plugin, for example :</p>
<ol>
<li>Window size are parameters</li>
<li>Easily open the Chromium console</li>
</ol>
<p><strong>1:</strong> Window size in parameters</p>
<ul>
<li>Add plugin properties with <em>Plugin studio</em></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="err">wi</span><span class="kc">n</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="err">wid</span><span class="kc">t</span><span class="err">h</span><span class="p">:</span><span class="w"> </span><span class="mi">150</span><span class="p">,</span>
<span class="w">    </span><span class="err">heigh</span><span class="kc">t</span><span class="p">:</span><span class="w"> </span><span class="mi">320</span><span class="p">,</span>
<span class="w">    </span><span class="err">opaci</span><span class="kc">t</span><span class="err">y</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="p">}</span>
<span class="err">devTools</span><span class="w"> </span><span class="err">=</span><span class="w"> </span><span class="kc">false</span>
</code></pre></div>
<p><img alt="weather-new-properties" src="../img/weather-new-properties.png" width="400" /></p>
<p><strong>2:</strong> Modify the <code>style</code> object to include the parameters</p>
<div class="highlight"><span class="filename">weather.js</span><pre><span></span><code><span class="kd">let</span><span class="w"> </span><span class="nx">style</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">parent</span><span class="o">:</span><span class="w"> </span><span class="nx">Avatar</span><span class="p">.</span><span class="nx">Interface</span><span class="p">.</span><span class="nx">mainWindow</span><span class="p">(),</span>
<span class="w">    </span><span class="nx">frame</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nx">movable</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">resizable</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nx">minimizable</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nx">alwaysOnTop</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">    </span><span class="nx">show</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="hll"><span class="w">    </span><span class="nx">width</span><span class="o">:</span><span class="w"> </span><span class="nx">Config</span><span class="p">.</span><span class="nx">modules</span><span class="p">.</span><span class="nx">weather</span><span class="p">.</span><span class="nx">win</span><span class="p">.</span><span class="nx">width</span><span class="p">,</span>
</span><span class="hll"><span class="w">    </span><span class="nx">height</span><span class="o">:</span><span class="w"> </span><span class="nx">Config</span><span class="p">.</span><span class="nx">modules</span><span class="p">.</span><span class="nx">weather</span><span class="p">.</span><span class="nx">win</span><span class="p">.</span><span class="nx">height</span><span class="p">,</span>
</span><span class="hll"><span class="w">    </span><span class="nx">opacity</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="nx">Config</span><span class="p">.</span><span class="nx">modules</span><span class="p">.</span><span class="nx">weather</span><span class="p">.</span><span class="nx">win</span><span class="p">.</span><span class="nx">opacity</span><span class="p">,</span>
</span><span class="w">    </span><span class="nx">icon</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;assets&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;images&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather.png&#39;</span><span class="p">),</span>
<span class="w">    </span><span class="nx">webPreferences</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">preload</span><span class="o">:</span><span class="w"> </span><span class="nx">path</span><span class="p">.</span><span class="nx">resolve</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;weather-preload.js&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;Weather forecast&quot;</span>
<span class="p">};</span>

<span class="p">......</span>
</code></pre></div>
<p><strong>3:</strong> Add Chromium console opening</p>
<div class="highlight"><span class="filename">weather.js</span><pre><span></span><code><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;ready-to-show&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
<span class="w">    </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">webContents</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="s1">&#39;onInit-weather&#39;</span><span class="p">);</span>
<span class="hll"><span class="w">    </span><span class="c1">// Displays the Chromium console if the devTools parameter is true</span>
</span><span class="hll"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">Config</span><span class="p">.</span><span class="nx">modules</span><span class="p">.</span><span class="nx">weather</span><span class="p">.</span><span class="nx">devTools</span><span class="p">)</span><span class="w"> </span><span class="nx">WeatherWindow</span><span class="p">.</span><span class="nx">webContents</span><span class="p">.</span><span class="nx">openDevTools</span><span class="p">();</span>
</span><span class="p">})</span>
</code></pre></div>
<ol>
<li>Restart A.V.A.T.A.R</li>
</ol>
<p>In the following example, we will transfer this plugin to a client</p>
<p><br><br>
<a class="md-button" href="../meteo/" style="float:left;"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 18V6h2v12zm3.5-6L18 6v12z"/></svg></span> Create a button button (Part 1)</a><a class="md-button" href="../meteo-widget-client/" style="float:right;">Transfer the plugin to a client (Part 3) <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M16 18h2V6h-2M6 18l8.5-6L6 6z"/></svg></span></a> <br />
<br><br></p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      &copy; 2024 <a href="https://github.com/Avatar-Home-Automation/" target="_blank" rel="noopener">A.V.A.T.A.R</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.top", "search.suggest", "search.highlight", "content.code.annotation", "content.code.copy", "content.tooltips"], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  </body>
</html>